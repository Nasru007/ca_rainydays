"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1412],{81412:function(e,t,r){r.d(t,{Z:function(){return D}});var n,o=r(85893),i=r(67294),a=r(26524),u=r(68302),c=(0,r(64364).I)("Socialway",(function(e){return{root:{width:"100%"},widthWrapper:{maxWidth:800},divider:{left:0,right:0},commentField:{marginBottom:e.spacing(4)},moreButton:{margin:"".concat(e.spacing(3),"px auto"),maxWidth:e.breakpoints.values.sm}}})),l=r(89402),s=r(63608);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(c){o=!0,i=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(n||(n={})).PRODUCT_SKU="productSku";function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(c){o=!0,i=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var m=function(e){var t,r,n,o,a,u=e.productSku,c=e.locale,m=e.skipPostFeedQuery,v=(0,s.a)(),y=v.user,b=v.isUserInitialized,h=function(e){var t=e.token,r=e.tags,n=e.locales,o=e.limit;return{variables:{filter:{locale:n,tags:Object.entries(r).map((function(e){var t=p(e,2);return{type:t[0],value:t[1]}}))},page:{limit:o||5}},context:{headers:{fwidtoken:t}}}}({token:null===y||void 0===y?void 0:y.token,locales:[c],tags:{productSku:u}}),w=(0,l.JHJ)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){f(e,t,r[t])}))}return e}({},h,{skip:m})),g=d((0,l.WjO)(),1)[0],x=d((0,l.tgF)(),1)[0],k=d((0,l.twO)({context:h.context}),2),C=k[0],j=k[1];(0,i.useEffect)((function(){b&&(null===y||void 0===y?void 0:y.token)&&!m&&(w.refetch(),C())}),[b]);return{viewer:(null===(t=j.data)||void 0===t?void 0:t.viewer)||{displayName:"",avatar:"",uuid:"",isFootwayEmployee:!1},posts:null===(r=w.data)||void 0===r||null===(n=r.postFeed)||void 0===n?void 0:n.posts,pageInfo:null===(o=w.data)||void 0===o||null===(a=o.postFeed)||void 0===a?void 0:a.pageInfo,getMorePosts:function(){var e,t,r;w.fetchMore({variables:{filter:h.variables.filter,page:{limit:5,afterCursor:null===(e=w.data)||void 0===e||null===(t=e.postFeed)||void 0===t||null===(r=t.pageInfo)||void 0===r?void 0:r.endCursor}}})},getMoreComments:function(e,t){return g({variables:{postUuid:e,page:{limit:5,afterCursor:t}}})},getMoreReplies:function(e,t,r){return x({variables:{postUuid:e,filter:{replyToCommentUuid:t},page:{limit:5,afterCursor:r}}})},loading:w.loading,error:w.error}},v=r(28520),y=r.n(v),b=r(46829),h=r(76882),w=r(27610);function g(e){if(Array.isArray(e))return e}function x(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(l){return void r(l)}u.done?t(c):Promise.resolve(c).then(n,o)}function k(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){x(i,n,o,a,u,"next",e)}function u(e){x(i,n,o,a,u,"throw",e)}a(void 0)}))}}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function O(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){C(e,t,r[t])}))}return e}function S(e,t){return g(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(c){o=!0,i=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(e,t)||O()}function U(e){return g(e)||j(e)||O()}function A(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var M=r(39675),I=r(43171),T=r(52683),E=r(2555);function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_(e,t,r[t])}))}return e}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(c){o=!0,i=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var D=function(e){var t=e.context,r=e.productSku,p=e.locale,f=e.storefront,d=e.posts,v=e.viewer,g=c(),x=R((0,u.D)(),2),C=x[0],j=x[1],O={open:!1,actions:[],title:"",content:""},_=(0,i.useState)(O),D=_[0],N=_[1],G=function(){return N(F({},O,{open:!1}))},W=function(e){var t=e.context,r=e.productSku,i=e.locale,u=e.storefront,c=e.showSnackbar,p=e.dialog,f=(0,a.$)().t,d=(0,s.a)(),m=d.user,v=d.checkAuth,g=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=U(b.useMutation.apply(void 0,A(t))),o=n[0],i=n.slice(1);return[v((function(e,t){return o(P({},e,{context:{headers:{fwidtoken:t||(null===m||void 0===m?void 0:m.token)}}}))}))].concat(A(i))},x=S(g(l.hC9,{onCompleted:function(e){e.deletePost.success&&c({text:f("post-deleted")})}}),1)[0],C=S(g(l._pf,{onCompleted:function(e){(e.reportPost.success||"Could not create report for post: report to post already exists for user"===e.reportPost.message)&&c({text:f("report-message")})}}),1)[0],j=S(g(l.nMg),1)[0],O=S(g(l.F4e),1)[0],M=S(g(l.qA9),1)[0],I=S(g(l.YAy,{onCompleted:function(e){e.deleteComment.success&&c({text:f("post-deleted")})}}),1)[0],T=function(e){return p.show({title:f("delete"),content:(0,o.jsx)(w._,{children:f("delete-message-prompt-text")}),actions:[{label:f("cancel"),onClick:function(){return p.close()},buttonColor:"default"},{label:f("delete"),onClick:k(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I({variables:{input:{uuid:e}}});case 2:p.close();case 3:case"end":return t.stop()}}),t)})))}]})},E=S(g(l.JXm,{onCompleted:function(e){(e.reportComment.success||"Could not create report for comment: report to comment already exists for user"===e.reportComment.message)&&c({text:f("report-message")})}}),1)[0],_=function(e){return p.show({title:f("report-post"),content:(0,o.jsx)(w._,{children:f("report-post-question")}),actions:[{label:f("cancel"),onClick:function(){return p.close()},buttonColor:"default"},{label:f("report-action"),onClick:k(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E({variables:{input:{uuid:e,report:{type:h.h.SPAM}}}});case 2:p.close();case 3:case"end":return t.stop()}}),t)})))}]})},F=S(g(l.lrv),1)[0],R=S(g(l.euZ),1)[0],D=function(e,t){t.isLikedByViewer?R({variables:{input:{uuid:e}}}):F({variables:{input:{uuid:e}}})},N=[{type:n.PRODUCT_SKU,value:r}],G={type:t,url:window.location.href},W=S((0,l.evS)(),1)[0],Z=S((0,l.iUG)(),1)[0],B=v(k(y().mark((function e(t,r,n){var o,a,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=11;break}return e.next=5,W({variables:{input:{mimeType:r.type}},context:{headers:{fwidtoken:n||(null===m||void 0===m?void 0:m.token)}}});case 5:if(null===(c=e.sent.data)||void 0===c||null===(a=c.createImageUploadUrl)||void 0===a?void 0:a.success){e.next=8;break}return e.abrupt("return");case 8:return o=c.createImageUploadUrl.imageRef,e.next=11,fetch(c.createImageUploadUrl.imageUploadUrl,{method:"PUT",body:r,headers:{"Content-Type":r.type}});case 11:return e.next=13,Z({variables:{input:{post:{body:t,tags:N,locale:i,storefront:u,source:G,media:r&&o?[{ref:o,type:r.type}]:void 0}}},context:{headers:{fwidtoken:n||(null===m||void 0===m?void 0:m.token)}}});case 13:case"end":return e.stop()}}),e)}))));return{post:{submit:k(y().mark((function e(t,r){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.image,e.abrupt("return",B(t,n));case 2:case"end":return e.stop()}}),e)}))),report:function(e){return p.show({title:f("report-post"),content:(0,o.jsx)(w._,{children:f("report-post-question")}),actions:[{label:f("cancel"),onClick:function(){return p.close()},buttonColor:"default"},{label:f("report-action"),onClick:k(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C({variables:{input:{uuid:e,report:{type:h.h.SPAM}}}});case 2:p.close();case 3:case"end":return t.stop()}}),t)})))}]})},delete:function(e){return p.show({title:f("delete"),content:(0,o.jsx)(w._,{children:f("delete-message-prompt-text")}),actions:[{label:f("cancel"),onClick:function(){return p.close()},buttonColor:"default"},{label:f("delete"),onClick:k(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x({variables:{input:{uuid:e}}});case 2:p.close();case 3:case"end":return t.stop()}}),t)})))}]})},toggleLike:function(e,t){t.isLikedByViewer?O({variables:{input:{uuid:e}}}):j({variables:{input:{uuid:e}}})}},comment:{submit:function(e,t){var r=t.postUuid;return M({variables:{input:{postUuid:r,comment:{body:e,locale:i,storefront:u,source:G}}}})},report:_,delete:T,toggleLike:D},reply:{submit:function(e,t){var r=t.postUuid,n=t.commentUuid;return M({variables:{input:{postUuid:r,replyToCommentUuid:n,comment:{body:e,locale:i,storefront:u,source:G}}}})},report:_,delete:T,toggleLike:D}}}({context:t,productSku:r,locale:p,storefront:f,showSnackbar:j,dialog:{show:function(e){return N(F({},e,{open:!0}))},close:G}}),Z=m({productSku:r,locale:p,skipPostFeedQuery:Boolean(d)}),B=Z.viewer,L=Z.posts,q=Z.pageInfo,V=Z.getMoreComments,J=Z.getMoreReplies,Q=Z.getMorePosts,z=Z.loading,K=Z.error,$=t===h.G.PRODUCT,H=(0,a.$)().t,X={like:H("like"),comment:H("comment-action"),report:H("report-action"),delete:H("delete"),postPlaceholder:H("write-a-comment"),commentPlaceholder:H("write-a-reply"),showMorePosts:H("show-more-posts"),showMoreComments:H("show-more-comments"),showMoreReplies:H("show-more-replies")};return z||K?(0,o.jsx)(I.w,{}):(0,o.jsxs)("div",{className:g.root,children:[(0,o.jsx)(T.A,{text:C.text,open:C.open}),(0,o.jsx)(E.V,{open:D.open,title:D.title,content:D.content,actions:D.actions,onClose:G}),(0,o.jsx)(M.Q,{viewer:v||B,actions:W,posts:d||L,pageInfo:q,translations:X,locale:p,showPostInput:$,onGetMorePosts:Q,onGetMoreComments:V,onGetMoreReplies:J})]})}},76882:function(e,t,r){var n,o,i;r.d(t,{G:function(){return n},h:function(){return i}}),(o=n||(n={})).PRODUCT="product",o.ACCOUNT="account",(i||(i={})).SPAM="spam"},2555:function(e,t,r){r.d(t,{V:function(){return p}});var n=r(85893),o=(r(67294),r(93579)),i=r(66083),a=r(29525),u=r(66856),c=r(33609),l=r(27610),s=r(68767),p=function(e){var t=e.open,r=e.title,p=e.content,f=e.actions,d=e.onClose,m=e.maxWidth,v=void 0===m?"sm":m,y=e.className;return(0,n.jsxs)(o.Z,{className:y,open:t,onClose:d,maxWidth:v,children:[(0,n.jsx)(i.Z,{children:(0,n.jsx)(s.q,{children:r})}),(0,n.jsx)(a.Z,{children:p}),(0,n.jsx)(u.Z,{children:f.map((function(e){var t=e.label,r=e.onClick,o=e.buttonColor,i=void 0===o?"primary":o;return(0,n.jsx)(c.z,{onClick:r,color:i,children:(0,n.jsx)(l._,{children:t})})}))})]})}}}]);